stages:
  - build
  - deploy

pact-macos:
  stage: build
  tags:
    - macos
  script:
    - nix-build
    - nix-build -A ghc.pact.doc
    - ./collectArtifacts.sh
  artifacts:
    paths:
    - public/

pact-linux:
  stage: build
  tags:
    - linux
  script:
    - nix-build

deploy-nix-cache:
  stage: deploy
  allow_failure: true
  script:
    - nix-instantiate | cachix push pact
    - nix-instantiate shell.nix | cachix push pact

pages:
  stage: deploy
  script:
  - echo 'Nothing to do...'
  artifacts:
    paths:
    - public/
